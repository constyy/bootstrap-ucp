+function(a){"use strict";function b(a,b){if(!(a instanceof b))throw new TypeError("Cannot call a class as a function")}var c=function(){function a(a,b){for(var c=0;c<b.length;c++){var d=b[c];d.enumerable=d.enumerable||!1,d.configurable=!0,"value"in d&&(d.writable=!0),Object.defineProperty(a,d.key,d)}}return function(b,c,d){return c&&a(b.prototype,c),d&&a(b,d),b}}();(function(a){var d="ekkoLightbox",e=a.fn[d],f={title:"",footer:"",left_arrow_class:".glyphicon .glyphicon-chevron-left",right_arrow_class:".glyphicon .glyphicon-chevron-right",directional_arrows:!0,type:null,always_show_close:!0,no_related:!1,scale_height:!0,loadingMessage:"Loading...",onShow:function(){},onShown:function(){},onHide:function(){},onHidden:function(){},onNavigate:function(){},onContentLoaded:function(){}},g=function(){function d(c,e){var g=this;b(this,d),this._config=a.extend({},f,e),this._$modalArrows=null,this._galleryIndex=0,this._galleryName=null,this._currentType=null,this._padding=null,this._border=null,this._modalId="ekkoLightbox-"+Math.floor(1e3*Math.random()+1),this._$element=c instanceof jQuery?c:a(c);var h='<div class="modal-header"'+(this._config.title||this._config.always_show_close?"":' style="display:none"')+'><button type="button" class="close" data-dismiss="modal" aria-label="Close"><span aria-hidden="true">&times;</span></button><h4 class="modal-title">'+(this._config.title||"&nbsp;")+"</h4></div>",i='<div class="modal-footer"'+(this._config.footer?"":' style="display:none"')+">"+(this._config.footer||"&nbsp;")+"</div>",j='<div class="modal-body"><div class="ekko-lightbox-container"><div></div></div></div>';a(document.body).append('<div id="'+this._modalId+'" class="ekko-lightbox modal fade" tabindex="-1" tabindex="-1" role="dialog" aria-hidden="true"><div class="modal-dialog" role="document"><div class="modal-content">'+h+j+i+"</div></div></div>"),this._$modal=a("#"+this._modalId),this._$modalDialog=this._$modal.find(".modal-dialog").first(),this._$modalContent=this._$modal.find(".modal-content").first(),this._$modalBody=this._$modal.find(".modal-body").first(),this._$modalHeader=this._$modal.find(".modal-header").first(),this._$modalFooter=this._$modal.find(".modal-footer").first(),this._$lightboxContainer=this._$modalBody.find(".ekko-lightbox-container").first(),this._$lightboxBody=this._$lightboxContainer.find("> div:first-child").first(),this._showLoading(),this._border=this._calculateBorders(),this._padding=this._calculatePadding(),this._galleryName=this._$element.data("gallery"),this._galleryName&&(this._$galleryItems=a(document.body).find('*[data-gallery="'+this._galleryName+'"]'),this._galleryIndex=this._$galleryItems.index(this._$element),a(document).on("keydown.ekkoLightbox",this._navigationalBinder.bind(this)),this._config.directional_arrows&&this._$galleryItems.length>1&&(this._$lightboxContainer.append('<div class="ekko-lightbox-nav-overlay"><a href="#" class="'+this._stripStops(this._config.left_arrow_class)+'"></a><a href="#" class="'+this._stripStops(this._config.right_arrow_class)+'"></a></div>'),this._$modalArrows=this._$lightboxContainer.find("div.ekko-lightbox-nav-overlay").first(),this._$lightboxContainer.find("a"+this._stripSpaces(this._config.left_arrow_class)).on("click",function(a){return a.preventDefault(),g.navigateLeft()}),this._$lightboxContainer.find("a"+this._stripSpaces(this._config.right_arrow_class)).on("click",function(a){return a.preventDefault(),g.navigateRight()}))),this._$modal.on("show.bs.modal",this._config.onShow.bind(this)).on("shown.bs.modal",function(){return g._handle(),g._config.onShown.call(g)}).on("hide.bs.modal",this._config.onHide.bind(this)).on("hidden.bs.modal",function(){return g._galleryName&&a(document).off("keydown.ekkoLightbox"),g._$modal.remove(),g._config.onHidden.call(g)}).modal(this._config)}return c(d,null,[{key:"Default",get:function(){return f}}]),c(d,[{key:"navigateTo",value:function(b){if(b<0||b>this._$galleryItems.length-1)return this;if(this._showLoading(),this._galleryIndex=b,this._$element=a(this._$galleryItems.get(this._galleryIndex)),this._handle(),this._galleryIndex+1<this._$galleryItems.length){var c=a(this._$galleryItems.get(this._galleryIndex+1),!1),d=c.attr("data-remote")||c.attr("href");if("image"===c.attr("data-type")||this._isImage(d))return this._preloadImage(d,!1)}}},{key:"navigateLeft",value:function(){if(1!==this._$galleryItems.length)return 0===this._galleryIndex?this._galleryIndex=this._$galleryItems.length-1:this._galleryIndex--,this._config.onNavigate.call(this,"left",this._galleryIndex),this.navigateTo(this._galleryIndex)}},{key:"navigateRight",value:function(){if(1!==this._$galleryItems.length)return this._galleryIndex===this._$galleryItems.length-1?this._galleryIndex=0:this._galleryIndex++,this._config.onNavigate.call(this,"right",this._galleryIndex),this.navigateTo(this._galleryIndex)}},{key:"close",value:function(){return this._$modal.modal("hide")}},{key:"resize",value:function(b){var c=this,d=b+this._border.left+this._padding.left+this._padding.right+this._border.right;return this._$modalDialog.css("width","auto").css("maxWidth",d),this._$lightboxContainer.find("a").css("line-height",function(){return a(c).parent().height()+"px"}),this}},{key:"_navigationalBinder",value:function(a){return a=a||window.event,39===a.keyCode?this.navigateRight():37===a.keyCode?this.navigateLeft():void 0}},{key:"_stripStops",value:function(a){return a.replace(/\./g,"")}},{key:"_stripSpaces",value:function(a){return a.replace(/\s/g,"")}},{key:"_detectRemoteType",value:function(a,b){return b=b||!1,!b&&this._isImage(a)&&(b="image"),!b&&this._getYoutubeId(a)&&(b="youtube"),!b&&this._getVimeoId(a)&&(b="vimeo"),!b&&this._getInstagramId(a)&&(b="instagram"),(!b||["image","youtube","vimeo","instagram","video","url"].indexOf(b)<0)&&(b="url"),b}},{key:"_handle",value:function(){this._updateTitleAndFooter();var a=this._$element.attr("data-remote")||this._$element.attr("href"),b=this._detectRemoteType(a,this._$element.attr("data-type")||!1);if(["image","youtube","vimeo","instagram","video","url"].indexOf(b)<0)return this._error('Could not detect remote target type. Force the type using data-type="image|youtube|vimeo|instagram|url|video"');switch(b){case"image":return this._preloadImage(a,!0);case"youtube":return this._showYoutubeVideo(this._getYoutubeId(a));case"vimeo":return this._showVimeoVideo(this._getVimeoId(a));case"instagram":return this._showInstagramVideo(this._getInstagramId(a));case"video":return this._showVideoIframe(a);default:return this._loadRemoteContent(a)}}},{key:"_isImage",value:function(a){return a.match(/(^data:image\/.*,)|(\.(jp(e|g|eg)|gif|png|bmp|webp|svg)((\?|#).*)?$)/i)}},{key:"_getYoutubeId",value:function(a){var b=a.match(/^.*(youtu.be\/|v\/|u\/\w\/|embed\/|watch\?v=|\&v=)([^#\&\?]*).*/);return!(!b||11!==b[2].length)&&b[2]}},{key:"_getVimeoId",value:function(a){return a.indexOf("vimeo")>0&&a}},{key:"_getInstagramId",value:function(a){return a.indexOf("instagram")>0&&a}},{key:"_calculateBorders",value:function(){return{top:this._totalCssByAttribute("border-top-width"),right:this._totalCssByAttribute("border-right-width"),bottom:this._totalCssByAttribute("border-bottom-width"),left:this._totalCssByAttribute("border-left-width")}}},{key:"_calculatePadding",value:function(){return{top:this._totalCssByAttribute("padding-top"),right:this._totalCssByAttribute("padding-right"),bottom:this._totalCssByAttribute("padding-bottom"),left:this._totalCssByAttribute("padding-left")}}},{key:"_totalCssByAttribute",value:function(a){return parseFloat(this._$modalDialog.css(a))+parseFloat(this._$modalContent.css(a))+parseFloat(this._$modalBody.css(a))}},{key:"_updateTitleAndFooter",value:function(){var a=this._$modalContent.find(".modal-header"),b=this._$modalContent.find(".modal-footer"),c=this._$element.data("title")||"",d=this._$element.data("footer")||"";return c||this._config.always_show_close?a.css("display","").find(".modal-title").html(c||"&nbsp;"):a.css("display","none"),d?b.css("display","").html(d):b.css("display","none"),this}},{key:"_showLoading",value:function(){return this._$lightboxBody.html('<div class="modal-loading">'+this._config.loadingMessage+"</div>"),this}},{key:"_showYoutubeVideo",value:function(a){var b=null!=this._$element.attr("data-norelated")||this._config.no_related?"&rel=0":"",c=this._checkDimensions(this._$element.data("width")||560);return this._showVideoIframe("//www.youtube.com/embed/"+a+"?badge=0&autoplay=1&html5=1"+b,c,c/(560/315))}},{key:"_showVimeoVideo",value:function(a){var b=this._checkDimensions(this._$element.data("width")||560),c=b/(500/281);return this._showVideoIframe(a+"?autoplay=1",b,c)}},{key:"_showInstagramVideo",value:function(a){var b=this._checkDimensions(this._$element.data("width")||612);this.resize(b);var c=b+80;if(a="/"!==a.substr(-1)?a+"/":a,this._$lightboxBody.html('<iframe width="'+b+'" height="'+c+'" src="'+a+'embed/" frameborder="0" allowfullscreen></iframe>'),this._config.onContentLoaded.call(this),this._$modalArrows)return this._$modalArrows.css("display","none")}},{key:"_showVideoIframe",value:function(a,b,c){return c=c||b,this.resize(b),this._$lightboxBody.html('<div class="embed-responsive embed-responsive-16by9"><iframe width="'+b+'" height="'+c+'" src="'+a+'" frameborder="0" allowfullscreen class="embed-responsive-item"></iframe></div>'),this._config.onContentLoaded.call(this),this._$modalArrows&&this._$modalArrows.css("display","none"),this}},{key:"_loadRemoteContent",value:function(b){var c=this,d=this._$element.data("width")||560;this.resize(d);var e=this._$element.data("disableExternalCheck")||!1;return e||this._isExternal(b)?(this._$lightboxBody.html('<iframe width="'+d+'" height="'+d+'" src="'+b+'" frameborder="0" allowfullscreen></iframe>'),this._config.onContentLoaded.call(this)):this._$lightboxBody.load(b,a.proxy(function(){return c._$element.trigger("loaded.bs.modal")})),this._$modalArrows&&this._$modalArrows.css("display","none"),this}},{key:"_isExternal",value:function(a){var b=a.match(/^([^:\/?#]+:)?(?:\/\/([^\/?#]*))?([^?#]+)?(\?[^#]*)?(#.*)?/);return"string"==typeof b[1]&&b[1].length>0&&b[1].toLowerCase()!==location.protocol||"string"==typeof b[2]&&b[2].length>0&&b[2].replace(new RegExp(":("+{"http:":80,"https:":443}[location.protocol]+")?$"),"")!==location.host}},{key:"_error",value:function(a){return this._$lightboxBody.html(a),this}},{key:"_preloadImage",value:function(b,c){var d=this,e=new Image;return null!=c&&c!==!0||(e.onload=function(){var b=a("<img />");return b.attr("src",e.src),b.addClass("img-fluid"),d._$lightboxBody.html(b),d._$modalArrows&&d._$modalArrows.css("display","block"),d._config.scale_height?d._scaleHeight(e.height,e.width):d.resize(e.width),d._config.onContentLoaded.call(d)},e.onerror=function(){return d._error("Failed to load image: "+b)}),e.src=b,e}},{key:"_scaleHeight",value:function(b,c){var d=this._$modalHeader.outerHeight(!0)||0,e=this._$modalFooter.outerHeight(!0)||0;this._$modalFooter.is(":visible")||(e=0),this._$modalHeader.is(":visible")||(d=0);var f=this._border.top+this._border.bottom+this._padding.top+this._padding.bottom,g=parseFloat(this._$modalDialog.css("margin-top"))+parseFloat(this._$modalDialog.css("margin-bottom")),h=a(window).height()-f-g-d-e,i=Math.min(h/b,1);return this._$modalDialog.css("height","auto").css("maxHeight",h),this.resize(i*c)}},{key:"_checkDimensions",value:function(a){var b=a+this._border.left+this._padding.left+this._padding.right+this._border.right;return b>document.body.clientWidth?this._$modalBody.width():a}}],[{key:"_jQueryInterface",value:function(b,c){var e=this;return this.each(function(){var c=a(e),f=a.extend({},d.Default,c.data(),"object"==typeof b&&b);new d(e,f)})}}]),d}();return a.fn[d]=g._jQueryInterface,a.fn[d].Constructor=g,a.fn[d].noConflict=function(){return a.fn[d]=e,g._jQueryInterface},g})(jQuery)}(jQuery);
//# sourceMappingURL=ekko-lightbox.min.js.map